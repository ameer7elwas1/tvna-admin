<!-- Modals -->
    <!-- Add Notification Modal -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ุฅุถุงูุฉ ุฅุดุนุงุฑ ุฌุฏูุฏ</h2>
                <span class="close" onclick="closeModal('notificationModal')">&times;</span>
            </div>
            <form id="notificationForm">
                <div class="form-group">
                    <label class="form-label">ุนููุงู ุงูุฅุดุนุงุฑ</label>
                    <input type="text" class="form-input" id="notificationTitle" placeholder="ุนููุงู ุงูุฅุดุนุงุฑ" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ูุญุชูู ุงูุฅุดุนุงุฑ</label>
                    <textarea class="form-input" id="notificationContent" placeholder="ูุญุชูู ุงูุฅุดุนุงุฑ" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ููุน ุงูุฅุดุนุงุฑ</label>
                    <select class="form-input" id="notificationType" required>
                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                        <option value="info">ูุนูููุงุช</option>
                        <option value="warning">ุชุญุฐูุฑ</option>
                        <option value="success">ูุฌุงุญ</option>
                        <option value="error">ุฎุทุฃ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="notificationActive" checked>
                        <span>ุงูุฅุดุนุงุฑ ูุดุท</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" id="addNotificationBtn">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงูุฅุดุนุงุฑ
                </button>
            </form>
        </div>
    </div>

    <!-- Add Advertisement Modal -->
    <div id="adModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ุฅุถุงูุฉ ุฅุนูุงู ุฌุฏูุฏ</h2>
                <span class="close" onclick="closeModal('adModal')">&times;</span>
            </div>
            <form id="adForm">
                <div class="form-group">
                    <label class="form-label">ุนููุงู ุงูุฅุนูุงู</label>
                    <input type="text" class="form-input" id="adTitle" placeholder="ุนููุงู ุงูุฅุนูุงู" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ูุตู ุงูุฅุนูุงู</label>
                    <textarea class="form-input" id="adDescription" placeholder="ูุตู ุงูุฅุนูุงู" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ุฑุงุจุท ุงูุฅุนูุงู</label>
                    <input type="url" class="form-input" id="adUrl" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">ุตูุฑุฉ ุงูุฅุนูุงู</label>
                    <div class="file-upload-area" id="adImageUpload">
                        <div class="file-upload-icon"><i class="fas fa-image"></i></div>
                        <div class="file-upload-text">ุงุถุบุท ูุงุฎุชูุงุฑ ุตูุฑุฉ</div>
                        <input type="file" id="adImageFile" accept="image/*" style="display: none;">
                    </div>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="adActive" checked>
                        <span>ุงูุฅุนูุงู ูุดุท</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" id="addAdBtnSubmit">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงูุฅุนูุงู
                </button>
            </form>
        </div>
    </div>

    <!-- Edit Channel Modal -->
    <div id="editChannelModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ุชุนุฏูู ุงูููุงุฉ</h2>
                <span class="close" onclick="closeModal('editChannelModal')">&times;</span>
            </div>
            <form id="editChannelForm">
                <input type="hidden" id="editChannelId">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">ุงุณู ุงูููุงุฉ (English)</label>
                        <input type="text" class="form-input" id="editChannelName" placeholder="Channel Name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงุณู ุงูููุงุฉ (ุงูุนุฑุจูุฉ)</label>
                        <input type="text" class="form-input" id="editChannelNameAr" placeholder="ุงุณู ุงูููุงุฉ ุจุงูุนุฑุจูุฉ" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุฑุงุจุท ุงูููุงุฉ</label>
                        <input type="url" class="form-input" id="editChannelUrl" placeholder="https://example.com/stream.m3u8" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงูุชุตููู</label>
                        <select class="form-input" id="editChannelCategory" required>
                            <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                            <option value="Sports">ุฑูุงุถุฉ</option>
                            <option value="News">ุฃุฎุจุงุฑ</option>
                            <option value="Entertainment">ุชุฑููู</option>
                            <option value="Movies">ุฃููุงู</option>
                            <option value="Kids">ุฃุทูุงู</option>
                            <option value="Music">ููุณููู</option>
                            <option value="Documentary">ูุซุงุฆูู</option>
                            <option value="Religious">ุฏููู</option>
                            <option value="General">ุนุงู</option>
                        </select>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div class="form-group">
                        <label class="form-label">ุงููุตู (English)</label>
                        <textarea class="form-input" id="editChannelDescription" placeholder="Channel Description" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงููุตู (ุงูุนุฑุจูุฉ)</label>
                        <textarea class="form-input" id="editChannelDescriptionAr" placeholder="ูุตู ุงูููุงุฉ ุจุงูุนุฑุจูุฉ" rows="3"></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="editIsPremium">
                        <span>โญ ููุงุฉ ูููุฒุฉ</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="editSupportsRecording">
                        <span>๐น ุชุฏุนู ุงูุชุณุฌูู</span>
                    </label>
                </div>

                                    <button type="submit" class="btn btn-primary" style="margin-top: 20px;" id="updateChannelBtn">
                    <i class="fas fa-save"></i> ุญูุธ ุงูุชุบููุฑุงุช
                </button>
            </form>
        </div>
    </div>

    <!-- Notifications List Modal -->
    <div id="notificationsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช</h2>
                <span class="close" onclick="closeModal('notificationsModal')">&times;</span>
            </div>
            <div id="notificationsContainer">
                <p style="text-align: center; color: rgba(255,255,255,0.6);">ุฌุงุฑู ุชุญููู ุงูุฅุดุนุงุฑุงุช...</p>
            </div>
        </div>
    </div>

    <!-- Advertisements List Modal -->
    <div id="advertisementsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ูุงุฆูุฉ ุงูุฅุนูุงูุงุช</h2>
                <span class="close" onclick="closeModal('advertisementsModal')">&times;</span>
            </div>
            <div id="advertisementsContainer">
                <p style="text-align: center; color: rgba(255,255,255,0.6);">ุฌุงุฑู ุชุญููู ุงูุฅุนูุงูุงุช...</p>
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://vpvvjascwgvidjyylzwp.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdnZqYXNjd2dpdmRqeXloendwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MDYxMjYsImV4cCI6MjA2NTM4MjEyNn0.6AR2-MG4x9ugNTXe9jUqx-IwGEtj1m6MCYwQkTsSbUQ';
        const SUPABASE_SERVICE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZwdnZqYXNjd2dpdmRqeXloendwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0OTgwNjEyNiwiZXhwIjoyMDY1MzgyMTI2fQ.HB1J1ArjF0idWdOXK3Xgaqu6fu_yXu5kYY_3gblxT4Q';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Global Data Storage
        let channels = [];
        let users = [];
        let notifications = [];
        let advertisements = [];

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ar-SA', options);
        }
        
        // Show alert
        function showAlert(message, type = 'info', duration = 5000) {
            const alertContainer = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            alertDiv.innerHTML = `
                <div class="alert-icon"><i class="${icons[type] || icons.info}"></i></div>
                <div>${message}</div>
            `;
            
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, duration);
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Show loading state
        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.innerHTML = '<div style="text-align: center; padding: 40px;"><div class="loading-spinner"></div><p>ุฌุงุฑู ุงูุชุญููู...</p></div>';
        }

        // Supabase Operations
        async function makeSupabaseRequest(table, operation = 'SELECT', data = null, filters = null) {
            try {
                let query = supabase.from(table);
                
                switch (operation) {
                    case 'SELECT':
                        query = query.select('*');
                        if (filters) {
                            Object.keys(filters).forEach(key => {
                                query = query.eq(key, filters[key]);
                            });
                        }
                        break;
                    case 'INSERT':
                        query = query.insert(data);
                        break;
                    case 'UPDATE':
                        query = query.update(data);
                        if (filters) {
                            Object.keys(filters).forEach(key => {
                                query = query.eq(key, filters[key]);
                            });
                        }
                        break;
                    case 'DELETE':
                        if (filters) {
                            Object.keys(filters).forEach(key => {
                                query = query.delete().eq(key, filters[key]);
                            });
                        }
                        break;
                }
                
                const { data: result, error } = await query;
                
                if (error) {
                    console.error('Supabase Error:', error);
                    throw error;
                }
                
                return result;
            } catch (error) {
                console.error('Request Error:', error);
                throw error;
            }
        }

        // Update statistics from Supabase
        async function updateStats() {
            try {
                const channelsData = await makeSupabaseRequest('channels');
                const usersData = await makeSupabaseRequest('users');
                const adsData = await makeSupabaseRequest('advertisements');
                const notificationsData = await makeSupabaseRequest('notifications');
                
                document.getElementById('totalChannels').textContent = channelsData?.length || 0;
                document.getElementById('totalUsers').textContent = usersData?.length || 0;
                document.getElementById('totalAds').textContent = adsData?.length || 0;
                document.getElementById('totalNotifications').textContent = notificationsData?.length || 0;
                
                // Update global arrays
                channels = channelsData || [];
                users = usersData || [];
                advertisements = adsData || [];
                notifications = notificationsData || [];
                
                return true;
            } catch (error) {
                console.error('Error updating stats:', error);
                showAlert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช', 'error');
                return false;
            }
        }

        // M3U Parser
        function parseM3U(content) {
            const lines = content.split('\n');
            const parsedChannels = [];
            let currentChannel = {};
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('#EXTINF:')) {
                    const info = line.substring(8);
                    const parts = info.split(',');
                    
                    if (parts.length >= 2) {
                        currentChannel.name = parts[1].trim();
                        currentChannel.name_ar = parts[1].trim();
                        
                        const attributes = parts[0];
                        if (attributes.includes('tvg-logo=')) {
                            const logoMatch = attributes.match(/tvg-logo="([^"]+)"/);
                            if (logoMatch) currentChannel.image_url = logoMatch[1];
                        }
                        
                        if (attributes.includes('group-title=')) {
                            const groupMatch = attributes.match(/group-title="([^"]+)"/);
                            if (groupMatch) currentChannel.category = groupMatch[1];
                        }
                    }
                } else if (line.startsWith('http')) {
                    currentChannel.url = line;
                    currentChannel.description = `ููุงุฉ ${currentChannel.name}`;
                    currentChannel.description_ar = `ููุงุฉ ${currentChannel.name_ar}`;
                    currentChannel.is_premium = false;
                    currentChannel.supports_recording = true;
                    currentChannel.category = currentChannel.category || 'General';
                    currentChannel.quality = 'HD';
                    currentChannel.viewers_count = 0;
                    currentChannel.rating = 4.0;
                    currentChannel.is_active = true;
                    currentChannel.language = 'Arabic';
                    currentChannel.created_at = new Date().toISOString();
                    
                    parsedChannels.push({ ...currentChannel });
                    currentChannel = {};
                }
            }
            
            return parsedChannels;
        }

        // Add channel to Supabase
        async function addChannel(channelData) {
            try {
                showLoading('channelsContainer');
                
                const result = await makeSupabaseRequest('channels', 'INSERT', channelData);
                
                if (result) {
                    showAlert(`ุชู ุฅุถุงูุฉ ุงูููุงุฉ "${channelData.name_ar || channelData.name}" ุจูุฌุงุญ!`, 'success');
                    await updateStats();
                    return result[0];
                }
            } catch (error) {
                console.error('Error adding channel:', error);
                showAlert(`ูุดู ุฅุถุงูุฉ ุงูููุงุฉ: ${error.message}`, 'error');
                return null;
            }
        }

        // Update channel in Supabase
        async function updateChannel(channelId, channelData) {
            try {
                const result = await makeSupabaseRequest('channels', 'UPDATE', channelData, { id: channelId });
                
                if (result) {
                    showAlert(`ุชู ุชุญุฏูุซ ุงูููุงุฉ "${channelData.name_ar || channelData.name}" ุจูุฌุงุญ!`, 'success');
                    await updateStats();
                    await showChannelsList();
                    return result[0];
                }
            } catch (error) {
                console.error('Error updating channel:', error);
                showAlert(`ูุดู ุชุญุฏูุซ ุงูููุงุฉ: ${error.message}`, 'error');
                return null;
            }
        }

        // Delete channel from Supabase
        async function deleteChannel(channelId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูููุงุฉุ')) {
                try {
                    await makeSupabaseRequest('channels', 'DELETE', null, { id: channelId });
                    showAlert('ุชู ุญุฐู ุงูููุงุฉ ุจูุฌุงุญ', 'success');
                    await updateStats();
                    await showChannelsList();
                } catch (error) {
                    console.error('Error deleting channel:', error);
                    showAlert(`ูุดู ุญุฐู ุงูููุงุฉ: ${error.message}`, 'error');
                }
            }
        }

        // Edit channel
        function editChannel(channelId) {
            const channel = channels.find(ch => ch.id == channelId);
            if (!channel) return;

            // Populate edit form
            document.getElementById('editChannelId').value = channel.id;
            document.getElementById('editChannelName').value = channel.name;
            document.getElementById('editChannelNameAr').value = channel.name_ar;
            document.getElementById('editChannelUrl').value = channel.url;
            document.getElementById('editChannelCategory').value = channel.category;
            document.getElementById('editChannelDescription').value = channel.description;
            document.getElementById('editChannelDescriptionAr').value = channel.description_ar;
            document.getElementById('editIsPremium').checked = channel.is_premium;
            document.getElementById('editSupportsRecording').checked = channel.supports_recording;

            openModal('editChannelModal');
        }

        // Add user to Supabase
        async function addUser(userData) {
            try {
                // Hash password for security
                userData.password_hash = btoa(userData.password);
                delete userData.password;
                userData.created_at = new Date().toISOString();
                
                const result = await makeSupabaseRequest('users', 'INSERT', userData);
                
                if (result) {
                    showAlert(`ุชู ุฅุถุงูุฉ ุงููุณุชุฎุฏู "${userData.username}" ุจูุฌุงุญ!`, 'success');
                    await updateStats();
                    return result[0];
                }
            } catch (error) {
                console.error('Error adding user:', error);
                showAlert(`ูุดู ุฅุถุงูุฉ ุงููุณุชุฎุฏู: ${error.message}`, 'error');
                return null;
            }
        }

        // Delete user from Supabase
        async function deleteUser(userId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุณุชุฎุฏูุ')) {
                try {
                    await makeSupabaseRequest('users', 'DELETE', null, { id: userId });
                    showAlert('ุชู ุญุฐู ุงููุณุชุฎุฏู ุจูุฌุงุญ', 'success');
                    await updateStats();
                    await showUsersList();
                } catch (error) {
                    console.error('Error deleting user:', error);
                    showAlert(`ูุดู ุญุฐู ุงููุณุชุฎุฏู: ${error.message}`, 'error');
                }
            }
        }

        // Add notification to Supabase
        async function addNotification(notificationData) {
            try {
                notificationData.created_at = new Date().toISOString();
                
                const result = await makeSupabaseRequest('notifications', 'INSERT', notificationData);
                
                if (result) {
                    showAlert('ุชู ุฅุถุงูุฉ ุงูุฅุดุนุงุฑ ุจูุฌุงุญ!', 'success');
                    await updateStats();
                    await loadNotifications();
                    return result[0];
                }
            } catch (error) {
                console.error('Error adding notification:', error);
                showAlert(`ูุดู ุฅุถุงูุฉ ุงูุฅุดุนุงุฑ: ${error.message}`, 'error');
                return null;
            }
        }

        // Delete notification from Supabase
        async function deleteNotification(notificationId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฅุดุนุงุฑุ')) {
                try {
                    await makeSupabaseRequest('notifications', 'DELETE', null, { id: notificationId });
                    showAlert('ุชู ุญุฐู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ', 'success');
                    await updateStats();
                    await loadNotifications();
                } catch (error) {
                    console.error('Error deleting notification:', error);
                    showAlert(`ูุดู ุญุฐู ุงูุฅุดุนุงุฑ: ${error.message}`, 'error');
                }
            }
        }

        // Add advertisement to Supabase
        async function addAdvertisement(adData) {
            try {
                adData.created_at = new Date().toISOString();
                
                const result = await makeSupabaseRequest('advertisements', 'INSERT', adData);
                
                if (result) {
                    showAlert('ุชู ุฅุถุงูุฉ ุงูุฅุนูุงู ุจูุฌุงุญ!', 'success');
                    await updateStats();
                    await loadAdvertisements();
                    return result[0];
                }
            } catch (error) {
                console.error('Error adding advertisement:', error);
                showAlert(`ูุดู ุฅุถุงูุฉ ุงูุฅุนูุงู: ${error.message}`, 'error');
                return null;
            }
        }

        // Delete advertisement from Supabase
        async function deleteAdvertisement(adId) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฅุนูุงูุ')) {
                try {
                    await makeSupabaseRequest('advertisements', 'DELETE', null, { id: adId });
                    showAlert('ุชู ุญุฐู ุงูุฅุนูุงู ุจูุฌุงุญ', 'success');
                    await updateStats();
                    await loadAdvertisements();
                } catch (error) {
                    console.error('Error deleting advertisement:', error);
                    showAlert(`ูุดู ุญุฐู ุงูุฅุนูุงู: ${error.message}`, 'error');
                }
            }
        }

        // Load and display notifications
        async function loadNotifications() {
            const container = document.getElementById('notificationsContainer');
            
            try {
                showLoading('notificationsContainer');
                const notificationsData = await makeSupabaseRequest('notifications');
                
                if (!notificationsData || notificationsData.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช</p>';
                    return;
                }
                
                container.innerHTML = notificationsData.map(notification => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${notification.title}</div>
                            <div class="item-actions">
                                <button class="btn btn-small btn-warning" onclick="editNotification('${notification.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="deleteNotification('${notification.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <p>${notification.content}</p>
                        <small>ุงูููุน: ${notification.type} | ${notification.is_active ? 'ูุดุท' : 'ุบูุฑ ูุดุท'} | ${new Date(notification.created_at).toLocaleDateString('ar-SA')}</small>
                    </div>
                `).join('');
                
                notifications = notificationsData;
            } catch (error) {
                console.error('Error loading notifications:', error);
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงูุฅุดุนุงุฑุงุช</p>';
            }
        }

        // Load and display advertisements
        async function loadAdvertisements() {
            const container = document.getElementById('adsContainer');
            
            try {
                showLoading('adsContainer');
                const adsData = await makeSupabaseRequest('advertisements');
                
                if (!adsData || adsData.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ุฅุนูุงูุงุช</p>';
                    return;
                }
                
                container.innerHTML = adsData.map(ad => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${ad.title}</div>
                            <div class="item-actions">
                                <button class="btn btn-small btn-warning" onclick="editAdvertisement('${ad.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-small btn-danger" onclick="deleteAdvertisement('${ad.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <p>${ad.description}</p>
                        ${ad.link ? `<p><a href="${ad.link}" target="_blank" style="color: #4ecdc4;">${ad.link}</a></p>` : ''}
                        <small>${ad.is_active ? 'ูุดุท' : 'ุบูุฑ ูุดุท'} | ${new Date(ad.created_at).toLocaleDateString('ar-SA')}</small>
                    </div>
                `).join('');
                
                advertisements = adsData;
            } catch (error) {
                console.error('Error loading advertisements:', error);
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงูุฅุนูุงูุงุช</p>';
            }
        }

        // Show users list from Supabase
        async function showUsersList() {
            openModal('usersModal');
            const container = document.getElementById('usersContainer');
            
            try {
                showLoading('usersContainer');
                const usersData = await makeSupabaseRequest('users');
                
                if (!usersData || usersData.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ูุณุชุฎุฏููู ูุณุฌููู</p>';
                } else {
                    container.innerHTML = usersData.map(user => `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-title">${user.username}</div>
                                <div class="item-actions">
                                    <button class="btn btn-small btn-warning" onclick="editUser('${user.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-small btn-danger" onclick="deleteUser('${user.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <p>ุงูุจุฑูุฏ: ${user.email}</p>
                            ${user.phone ? `<p>ุงููุงุชู: ${user.phone}</p>` : ''}
                            <small>${user.is_premium ? 'โญ ูููุฒ' : '๐ค ุนุงุฏู'} | ${user.is_active ? 'โ ูุดุท' : 'โ ุบูุฑ ูุดุท'} | ${new Date(user.created_at).toLocaleDateString('ar-SA')}</small>
                        </div>
                    `).join('');
                }
                
                users = usersData || [];
            } catch (error) {
                console.error('Error loading users:', error);
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงููุณุชุฎุฏููู</p>';
            }
        }

        // Show channels list from Supabase
        async function showChannelsList() {
            openModal('channelsModal');
            const container = document.getElementById('channelsContainer');
            
            try {
                showLoading('channelsContainer');
                const channelsData = await makeSupabaseRequest('channels');
                
                if (!channelsData || channelsData.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ูููุงุช ูุถุงูุฉ</p>';
                } else {
                    container.innerHTML = channelsData.map(channel => `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-title">${channel.name_ar || channel.name}</div>
                                <div class="item-actions">
                                    <button class="btn btn-small btn-success" onclick="editChannel('${channel.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-small btn-danger" onclick="deleteChannel('${channel.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <p>ุงูุชุตููู: ${channel.category}</p>
                            <p>ุงูุฌูุฏุฉ: ${channel.quality || 'HD'} | ุงููุดุงูุฏูู: ${channel.viewers_count || 0}</p>
                            <p style="word-break: break-all; font-size: 12px; color: rgba(255,255,255,0.7);">${channel.url}</p>
                            <small>${channel.is_premium ? 'โญ ูููุฒุฉ' : '๐บ ุนุงุฏูุฉ'} | ${channel.supports_recording ? '๐น ุชุณุฌูู' : '๐ซ ุจุฏูู ุชุณุฌูู'} | ${channel.is_active ? 'โ ูุดุทุฉ' : 'โ ุบูุฑ ูุดุทุฉ'}</small>
                        </div>
                    `).join('');
                }
                
                channels = channelsData || [];
            } catch (error) {
                console.error('Error loading channels:', error);
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงููููุงุช</p>';
            }
        }

        // Show notifications list
        function showNotificationsList() {
            loadNotifications();
        }

        // Show ads list  
        function showAdsList() {
            loadAdvertisements();
        }

        // Database management functions
        function backupDatabase() {
            showAlert('ุฌุงุฑู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช...', 'info');
            setTimeout(() => {
                showAlert('ุชู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจูุฌุงุญ!', 'success');
            }, 2000);
        }
        
        function optimizeDatabase() {
            showAlert('ุฌุงุฑู ุชุญุณูู ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช...', 'info');
            setTimeout(() => {
                showAlert('ุชู ุชุญุณูู ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ!', 'success');
            }, 2000);
        }
        
        function showDatabaseStats() {
            showAlert('ุชู ุชุญููู ุฅุญุตุงุฆูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช', 'success');
        }

        // Edit functions (placeholder implementations)
        function editUser(userId) {
            showAlert('ุณูุชู ุฅุถุงูุฉ ูุงูุฐุฉ ุชุนุฏูู ุงููุณุชุฎุฏู ูุฑูุจุงู', 'info');
        }

        function editNotification(notificationId) {
            showAlert('ุณูุชู ุฅุถุงูุฉ ูุงูุฐุฉ ุชุนุฏูู ุงูุฅุดุนุงุฑ ูุฑูุจุงู', 'info');
        }

        function editAdvertisement(adId) {
            showAlert('ุณูุชู ุฅุถุงูุฉ ูุงูุฐุฉ ุชุนุฏูู ุงูุฅุนูุงู ูุฑูุจุงู', 'info');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', async function() {
            updateDateTime();
            setInterval(updateDateTime, 60000);
            
            // Check Supabase connection and load initial data
            try {
                document.getElementById('connectionText').innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช...';
                
                // Test connection and load data
                await updateStats();
                
                document.getElementById('connectionStatus').className = 'connection-status status-connected';
                document.getElementById('connectionText').textContent = 'โ ูุชุตู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช - Supabase';
                showAlert('ุชู ุงูุงุชุตุงู ุจูุฌุงุญ ุจูุงุนุฏุฉ ุงูุจูุงูุงุช', 'success');
            } catch (error) {
                console.error('Error connecting to Supabase:', error);
                document.getElementById('connectionStatus').className = 'connection-status status-disconnected';
                document.getElementById('connectionText').textContent = 'โ ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช';
                showAlert('ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช: ' + error.message, 'error');
            }
            
            // Initialize file uploads
            const channelImageUpload = document.getElementById('channelImageUpload');
            const channelImageFile = document.getElementById('channelImageFile');
            const channelImagePreview = document.getElementById('channelImagePreview');
            
            channelImageUpload.addEventListener('click', () => {
                channelImageFile.click();
            });
            
            channelImageFile.addEventListener('change', function(e) {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        channelImagePreview.src = e.target.result;
                        channelImagePreview.style.display = 'block';
                    }
                    reader.readAsDataURL(this.files[0]);
                }
            });

            // M3U file upload
            const m3uUpload = document.getElementById('m3uUpload');
            const m3uFile = document.getElementById('m3uFile');
            
            m3uUpload.addEventListener('click', () => {
                m3uFile.click();
            });
            
            m3uFile.addEventListener('change', async function(e) {
                if (this.files && this.files[0]) {
                    const file = this.files[0];
                    const reader = new FileReader();
                    
                    document.getElementById('m3uProgress').style.display = 'block';
                    let progress = 0;
                    
                    const progressInterval = setInterval(() => {
                        progress += 10;
                        document.getElementById('progressFill').style.width = progress + '%';
                        
                        if (progress >= 100) {
                            clearInterval(progressInterval);
                        }
                    }, 200);
                    
                    reader.onload = async function(e) {
                        const content = e.target.result;
                        const parsedChannels = parseM3U(content);
                        
                        let successCount = 0;
                        let failCount = 0;
                        
                        for (const channel of parsedChannels) {
                            try {
                                await addChannel(channel);
                                successCount++;
                            } catch (error) {
                                failCount++;
                                console.error('Failed to add channel:', channel.name, error);
                            }
                        }
                        
                        document.getElementById('progressText').textContent = 'ุชู ุงูุงูุชูุงุก!';
                        
                        if (successCount > 0) {
                            showAlert(`ุชู ุฅุถุงูุฉ ${successCount} ููุงุฉ ูู ููู M3U ุจูุฌุงุญ!`, 'success');
                        }
                        if (failCount > 0) {
                            showAlert(`ูุดู ุฅุถุงูุฉ ${failCount} ููุงุฉ`, 'warning');
                        }
                        
                        setTimeout(() => {
                            document.getElementById('m3uProgress').style.display = 'none';
                        }, 2000);
                    };
                    
                    reader.readAsText(file);
                }
            });

            // Ad image upload
            const adImageUpload = document.getElementById('adImageUpload');
            const adImageFile = document.getElementById('adImageFile');
            
            adImageUpload.addEventListener('click', () => {
                adImageFile.click();
            });
            
            // Form submissions
            document.getElementById('addUserForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const addUserBtn = document.getElementById('addUserBtn');
                const originalText = addUserBtn.innerHTML;
                addUserBtn.innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุฅุถุงูุฉ...';
                addUserBtn.disabled = true;
                
                const userData = {
                    username: document.getElementById('userName').value,
                    email: document.getElementById('userEmail').value,
                    password: document.getElementById('userPassword').value,
                    phone: document.getElementById('userPhone').value,
                    is_premium: document.getElementById('userIsPremium').checked,
                    is_active: document.getElementById('userIsActive').checked
                };
                
                await addUser(userData);
                this.reset();
                
                addUserBtn.innerHTML = originalText;
                addUserBtn.disabled = false;
            });
            
            document.getElementById('addChannelForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const addChannelBtn = document.getElementById('addChannelBtn');
                const originalText = addChannelBtn.innerHTML;
                addChannelBtn.innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุฅุถุงูุฉ...';
                addChannelBtn.disabled = true;
                
                const channelData = {
                    name: document.getElementById('channelName').value,
                    name_ar: document.getElementById('channelNameAr').value,
                    url: document.getElementById('channelUrl').value,
                    category: document.getElementById('channelCategory').value,
                    description: document.getElementById('channelDescription').value,
                    description_ar: document.getElementById('channelDescriptionAr').value,
                    is_premium: document.getElementById('isPremium').checked,
                    supports_recording: document.getElementById('supportsRecording').checked,
                    quality: 'HD',
                    viewers_count: 0,
                    rating: 4.0,
                    is_active: true,
                    language: 'Arabic'
                };
                
                // Add image URL if uploaded
                if (channelImagePreview.src && channelImagePreview.style.display !== 'none') {
                    channelData.image_url = channelImagePreview.src;
                } else {
                    channelData.image_url = 'https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=400&h=300';
                }
                
                await addChannel(channelData);
                this.reset();
                channelImagePreview.style.display = 'none';
                
                addChannelBtn.innerHTML = originalText;
                addChannelBtn.disabled = false;
            });

            // Edit channel form submission
            document.getElementById('editChannelForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const updateChannelBtn = document.getElementById('updateChannelBtn');
                const originalText = updateChannelBtn.innerHTML;
                updateChannelBtn.innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุชุญุฏูุซ...';
                updateChannelBtn.disabled = true;
                
                const channelId = document.getElementById('editChannelId').value;
                const channelData = {
                    name: document.getElementById('editChannelName').value,
                    name_ar: document.getElementById('editChannelNameAr').value,
                    url: document.getElementById('editChannelUrl').value,
                    category: document.getElementById('editChannelCategory').value,
                    description: document.getElementById('editChannelDescription').value,
                    description_ar: document.getElementById('editChannelDescriptionAr').value,
                    is_premium: document.getElementById('editIsPremium').checked,
                    supports_recording: document.getElementById('editSupportsRecording').checked,
                    updated_at: new Date().toISOString()
                };
                
                await updateChannel(channelId, channelData);
                closeModal('editChannelModal');
                
                updateChannelBtn.innerHTML = originalText;
                updateChannelBtn.disabled = false;
            });

            document.getElementById('notificationForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const addNotificationBtnSubmit = document.getElementById('addNotificationBtn');
                const originalText = addNotificationBtnSubmit.innerHTML;
                addNotificationBtnSubmit.innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุฅุถุงูุฉ...';
                addNotificationBtnSubmit.disabled = true;
                
                const notificationData = {
                    title: document.getElementById('notificationTitle').value,
                    content: document.getElementById('notificationContent').value,
                    type: document.getElementById('notificationType').value,
                    is_active: document.getElementById('notificationActive').checked
                };
                
                await addNotification(notificationData);
                this.reset();
                closeModal('notificationModal');
                
                addNotificationBtnSubmit.innerHTML = originalText;
                addNotificationBtnSubmit.disabled = false;
            });

            document.getElementById('adForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const addAdBtnSubmit = document.getElementById('addAdBtnSubmit');
                const originalText = addAdBtnSubmit.innerHTML;
                addAdBtnSubmit.innerHTML = '<span class="loading-spinner"></span> ุฌุงุฑู ุงูุฅุถุงูุฉ...';
                addAdBtnSubmit.disabled = true;
                
                const adData = {
                    title: document.getElementById('adTitle').value,
                    description: document.getElementById('adDescription').value,
                    link: document.getElementById('adUrl').value,
                    is_active: document.getElementById('adActive').checked,
                    image_url: 'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=400&h=200'
                };
                
                await addAdvertisement(adData);
                this.reset();
                closeModal('adModal');
                
                addAdBtnSubmit.innerHTML = originalText;
                addAdBtnSubmit.disabled = false;
            });
            
            // Button event listeners
            document.getElementById('addNotificationBtn').addEventListener('click', function() {
                openModal('notificationModal');
            });
            
            document.getElementById('addAdBtn').addEventListener('click', function() {
                openModal('adModal');
            });
            
            document.getElementById('refreshNotificationsBtn').addEventListener('click', function() {
                loadNotifications();
                showAlert('ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช', 'success');
            });
            
            document.getElementById('refreshAdsBtn').addEventListener('click', function() {
                loadAdvertisements();
                showAlert('ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุฅุนูุงูุงุช', 'success');
            });

            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            });
            
            // Initialize data loading
            await loadNotifications();
            await loadAdvertisements();
            
            // Show initial alerts
            setTimeout(() => {
                showAlert('ูุฑุญุจุงู ุจู ูู ููุญุฉ ุชุญูู TvNa ุงููุทูุฑุฉ ูุน Supabase!', 'info');
                showAlert('ุฌููุน ุงููุธุงุฆู ูุชุงุญุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู', 'success');
            }, 1000);
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TvNa - ููุญุฉ ุงูุชุญูู</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 1;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .logo-text h1 {
            font-size: 28px;
            margin-bottom: 5px;
            background: linear-gradient(135deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .admin-info {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        /* Connection Status */
        .connection-status {
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }

        .status-connected {
            background: linear-gradient(135deg, #00b894, #00a085);
        }

        .status-disconnected {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        /* Card Styles */
        .card {
            background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
        }

        .card-header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card-header-right {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .card-subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate 4s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #4ecdc4;
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.3);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .file-upload-area {
            border: 2px dashed rgba(78, 205, 196, 0.5);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(78, 205, 196, 0.05);
        }

        .file-upload-area:hover {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }

        .file-upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #4ecdc4;
        }

        .file-upload-text {
            font-size: 18px;
            margin-bottom: 10px;
            color: #4ecdc4;
        }

        .file-upload-hint {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Button Styles */
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: inline-block;
            text-decoration: none;
            text-align: center;
            font-size: 14px;
        }

        .btn-small {
            padding: 8px 12px;
            font-size: 12px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #feca57, #ff9ff3);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #ff6b6b;
        }

        /* Alert Container */
        .alert-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 400px;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
        }

        .alert-error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .alert-warning {
            background: linear-gradient(135deg, #feca57, #ff9ff3);
            color: white;
        }

        .alert-info {
            background: linear-gradient(135deg, #2e86de, #1a73e8);
            color: white;
        }

        .alert-icon {
            font-size: 24px;
        }

        /* Data Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table th {
            background: rgba(78, 205, 196, 0.1);
            color: #4ecdc4;
            font-weight: bold;
        }

        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .item-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .item-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .item-title {
            font-weight: bold;
            color: #4ecdc4;
        }

        .item-actions {
            display: flex;
            gap: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .card-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .card-header-right {
                width: 100%;
                justify-content: flex-start;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .modal-content {
                margin: 10% auto;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <!-- Alert Container -->
    <div class="alert-container" id="alertContainer"></div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"><i class="fas fa-tv"></i></div>
                    <div class="logo-text">
                        <h1>TvNa</h1>
                        <p>ููุญุฉ ุงูุชุญูู</p>
                    </div>
                </div>
                <div class="admin-info">
                    <p><strong>ุฃููุฑ ุญููุงุต</strong></p>
                    <p>ูุฏูุฑ ุงููุธุงู</p>
                    <p id="currentDate">ุงูุฃุฑุจุนุงุกุ 18 ููููู 2025</p>
                </div>
            </div>
        </div>

        <!-- Connection Status -->
        <div id="connectionStatus" class="connection-status status-connected">
            โ ูุชุตู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช - Ameer_7elwas
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card" onclick="showChannelsList()">
                <div class="stat-number" id="totalChannels">0</div>
                <div class="stat-label"><i class="fas fa-tv"></i> ุฅุฌูุงูู ุงููููุงุช</div>
            </div>
            <div class="stat-card" onclick="showUsersList()">
                <div class="stat-number" id="totalUsers">0</div>
                <div class="stat-label"><i class="fas fa-users"></i> ุงููุณุชุฎุฏููู ุงููุณุฌููู</div>
            </div>
            <div class="stat-card" onclick="showAdsList()">
                <div class="stat-number" id="totalAds">0</div>
                <div class="stat-label"><i class="fas fa-ad"></i> ุงูุฅุนูุงูุงุช ุงููุดุทุฉ</div>
            </div>
            <div class="stat-card" onclick="showNotificationsList()">
                <div class="stat-number" id="totalNotifications">0</div>
                <div class="stat-label"><i class="fas fa-bell"></i> ุงูุฅุดุนุงุฑุงุช ุงููุดุทุฉ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">127</div>
                <div class="stat-label"><i class="fas fa-eye"></i> ุฅุฌูุงูู ุงููุดุงูุฏุงุช</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">45</div>
                <div class="stat-label"><i class="fas fa-heart"></i> ุฅุฌูุงูู ุงูููุถูุฉ</div>
            </div>
        </div>

        <!-- M3U Upload Section -->
        <div class="card">
            <div class="card-header">
                <div class="card-header-left">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ff9a9e, #fecfef);">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <div>
                        <div class="card-title">ุฑูุน ููู ูููุงุช M3U</div>
                        <div class="card-subtitle">ุฅุถุงูุฉ ูููุงุช ูุชุนุฏุฏุฉ ูู ููู M3U</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">ููู M3U</label>
                <div class="file-upload-area" id="m3uUpload">
                    <div class="file-upload-icon"><i class="fas fa-file-code"></i></div>
                    <div class="file-upload-text">ุงุถุบุท ูุงุฎุชูุงุฑ ููู M3U</div>
                    <div class="file-upload-hint">ูุฏุนู: .m3u, .m3u8 (ุญุฏ ุฃูุตู 10MB)</div>
                    <input type="file" id="m3uFile" accept=".m3u,.m3u8" style="display: none;">
                </div>
                <div id="m3uProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText">ุฌุงุฑู ุงููุนุงูุฌุฉ...</p>
                </div>
            </div>
        </div>

        <!-- Add User Section -->
        <div class="card">
            <div class="card-header">
                <div class="card-header-left">
                    <div class="card-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div>
                        <div class="card-title">ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ</div>
                        <div class="card-subtitle">ุฅูุดุงุก ุญุณุงุจ ูุณุชุฎุฏู ุฌุฏูุฏ</div>
                    </div>
                </div>
                <div class="card-header-right">
                    <button class="btn btn-secondary" onclick="showUsersList()"><i class="fas fa-list"></i> ุนุฑุถ ุงููุณุชุฎุฏููู</button>
                </div>
            </div>
            
            <form id="addUserForm">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">ุงุณู ุงููุณุชุฎุฏู</label>
                        <input type="text" class="form-input" id="userName" placeholder="ุงุณู ุงููุณุชุฎุฏู" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" class="form-input" id="userEmail" placeholder="user@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ูููุฉ ุงููุฑูุฑ</label>
                        <input type="password" class="form-input" id="userPassword" placeholder="ูููุฉ ุงููุฑูุฑ" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุฑูู ุงููุงุชู</label>
                        <input type="tel" class="form-input" id="userPhone" placeholder="+964 xxx xxx xxxx">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="userIsPremium">
                        <span>โญ ุญุณุงุจ ูููุฒ</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="userIsActive" checked>
                        <span>โ ุงูุญุณุงุจ ูุดุท</span>
                    </label>
                </div>

                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงููุณุชุฎุฏู
                </button>
            </form>
        </div>

        <!-- Notifications Management -->
        <div class="card">
            <div class="card-header">
                <div class="card-header-left">
                    <div class="card-icon" style="background: linear-gradient(135deg, #8e44ad, #9b59b6);">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div>
                        <div class="card-title">ุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช</div>
                        <div class="card-subtitle">ุฅุถุงูุฉ ูุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู</div>
                    </div>
                </div>
                <div class="card-header-right">
                    <button class="btn btn-primary" id="addNotificationBtn"><i class="fas fa-plus"></i> ุฅุดุนุงุฑ ุฌุฏูุฏ</button>
                    <button class="btn btn-warning" id="refreshNotificationsBtn"><i class="fas fa-sync"></i> ุชุญุฏูุซ</button>
                </div>
            </div>
            
            <div class="notifications-container" id="notificationsContainer">
                <!-- Notifications will be populated dynamically -->
            </div>
        </div>

        <!-- Advertisements Management -->
        <div class="card">
            <div class="card-header">
                <div class="card-header-left">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ff6b6b, #ee5a6f);">
                        <i class="fas fa-ad"></i>
                    </div>
                    <div>
                        <div class="card-title">ุฅุฏุงุฑุฉ ุงูุฅุนูุงูุงุช</div>
                        <div class="card-subtitle">ุฅุถุงูุฉ ูุชุนุฏูู ุงูุฅุนูุงูุงุช ุงููุนุฑูุถุฉ ูู ุงูุชุทุจูู</div>
                    </div>
                </div>
                <div class="card-header-right">
                    <button class="btn btn-primary" id="addAdBtn"><i class="fas fa-plus"></i> ุฅุนูุงู ุฌุฏูุฏ</button>
                    <button class="btn btn-warning" id="refreshAdsBtn"><i class="fas fa-sync"></i> ุชุญุฏูุซ</button>
                </div>
            </div>
            
            <div class="ads-container" id="adsContainer">
                <!-- Advertisements will be populated dynamically -->
            </div>
        </div>

        <!-- Add Channel Section -->
        <div class="card">
            <div class="card-header">
                <div class="card-header-left">
                    <div class="card-icon" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
                        <i class="fas fa-tv"></i>
                    </div>
                    <div>
                        <div class="card-title">ุฅุถุงูุฉ ููุงุฉ ุฌุฏูุฏุฉ</div>
                        <div class="card-subtitle">ุฃุถู ููุงุฉ ุฌุฏูุฏุฉ ูุน ุฅููุงููุฉ ุฑูุน ุตูุฑุฉ</div>
                    </div>
                </div>
                <div class="card-header-right">
                    <button class="btn btn-secondary" onclick="showChannelsList()"><i class="fas fa-list"></i> ุนุฑุถ ุงููููุงุช</button>
                </div>
            </div>
            
            <form id="addChannelForm">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div class="form-group">
                        <label class="form-label">ุงุณู ุงูููุงุฉ (English)</label>
                        <input type="text" class="form-input" id="channelName" placeholder="Channel Name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงุณู ุงูููุงุฉ (ุงูุนุฑุจูุฉ)</label>
                        <input type="text" class="form-input" id="channelNameAr" placeholder="ุงุณู ุงูููุงุฉ ุจุงูุนุฑุจูุฉ" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุฑุงุจุท ุงูููุงุฉ</label>
                        <input type="url" class="form-input" id="channelUrl" placeholder="https://example.com/stream.m3u8" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงูุชุตููู</label>
                        <select class="form-input" id="channelCategory" required>
                            <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                            <option value="Sports">ุฑูุงุถุฉ</option>
                            <option value="News">ุฃุฎุจุงุฑ</option>
                            <option value="Entertainment">ุชุฑููู</option>
                            <option value="Movies">ุฃููุงู</option>
                            <option value="Kids">ุฃุทูุงู</option>
                            <option value="Music">ููุณููู</option>
                            <option value="Documentary">ูุซุงุฆูู</option>
                            <option value="Religious">ุฏููู</option>
                            <option value="General">ุนุงู</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label class="form-label">ุตูุฑุฉ ุงูููุงุฉ</label>
                    <div class="file-upload-area" id="channelImageUpload">
                        <div class="file-upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <div class="file-upload-text">ุงุถุบุท ูุงุฎุชูุงุฑ ุตูุฑุฉ</div>
                        <div class="file-upload-hint">ูุฏุนู: JPG, PNG, GIF (ุญุฏ ุฃูุตู 5MB)</div>
                        <input type="file" id="channelImageFile" accept="image/*" style="display: none;">
                    </div>
                    <img id="channelImagePreview" class="image-preview" style="display: none; max-width: 200px; margin-top: 15px; border-radius: 10px;">
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                    <div class="form-group">
                        <label class="form-label">ุงููุตู (English)</label>
                        <textarea class="form-input" id="channelDescription" placeholder="Channel Description" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ุงููุตู (ุงูุนุฑุจูุฉ)</label>
                        <textarea class="form-input" id="channelDescriptionAr" placeholder="ูุตู ุงูููุงุฉ ุจุงูุนุฑุจูุฉ" rows="3"></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="isPremium">
                        <span>โญ ููุงุฉ ูููุฒุฉ</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="supportsRecording" checked>
                        <span>๐น ุชุฏุนู ุงูุชุณุฌูู</span>
                    </label>
                </div>

                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงูููุงุฉ
                </button>
            </form>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Notification Modal -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ุฅุถุงูุฉ ุฅุดุนุงุฑ ุฌุฏูุฏ</h2>
                <span class="close" onclick="closeModal('notificationModal')">&times;</span>
            </div>
            <form id="notificationForm">
                <div class="form-group">
                    <label class="form-label">ุนููุงู ุงูุฅุดุนุงุฑ</label>
                    <input type="text" class="form-input" id="notificationTitle" placeholder="ุนููุงู ุงูุฅุดุนุงุฑ" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ูุญุชูู ุงูุฅุดุนุงุฑ</label>
                    <textarea class="form-input" id="notificationContent" placeholder="ูุญุชูู ุงูุฅุดุนุงุฑ" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ููุน ุงูุฅุดุนุงุฑ</label>
                    <select class="form-input" id="notificationType" required>
                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                        <option value="info">ูุนูููุงุช</option>
                        <option value="warning">ุชุญุฐูุฑ</option>
                        <option value="success">ูุฌุงุญ</option>
                        <option value="error">ุฎุทุฃ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="notificationActive" checked>
                        <span>ุงูุฅุดุนุงุฑ ูุดุท</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงูุฅุดุนุงุฑ
                </button>
            </form>
        </div>
    </div>

    <!-- Add Advertisement Modal -->
    <div id="adModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ุฅุถุงูุฉ ุฅุนูุงู ุฌุฏูุฏ</h2>
                <span class="close" onclick="closeModal('adModal')">&times;</span>
            </div>
            <form id="adForm">
                <div class="form-group">
                    <label class="form-label">ุนููุงู ุงูุฅุนูุงู</label>
                    <input type="text" class="form-input" id="adTitle" placeholder="ุนููุงู ุงูุฅุนูุงู" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ูุตู ุงูุฅุนูุงู</label>
                    <textarea class="form-input" id="adDescription" placeholder="ูุตู ุงูุฅุนูุงู" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ุฑุงุจุท ุงูุฅุนูุงู</label>
                    <input type="url" class="form-input" id="adUrl" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">ุตูุฑุฉ ุงูุฅุนูุงู</label>
                    <div class="file-upload-area" id="adImageUpload">
                        <div class="file-upload-icon"><i class="fas fa-image"></i></div>
                        <div class="file-upload-text">ุงุถุบุท ูุงุฎุชูุงุฑ ุตูุฑุฉ</div>
                        <input type="file" id="adImageFile" accept="image/*" style="display: none;">
                    </div>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="adActive" checked>
                        <span>ุงูุฅุนูุงู ูุดุท</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุงูุฅุนูุงู
                </button>
            </form>
        </div>
    </div>

    <!-- Users List Modal -->
    <div id="usersModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ูุงุฆูุฉ ุงููุณุชุฎุฏููู</h2>
                <span class="close" onclick="closeModal('usersModal')">&times;</span>
            </div>
            <div id="usersContainer"></div>
        </div>
    </div>

    <!-- Channels List Modal -->
    <div id="channelsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ูุงุฆูุฉ ุงููููุงุช</h2>
                <span class="close" onclick="closeModal('channelsModal')">&times;</span>
            </div>
            <div id="channelsContainer"></div>
        </div>
    </div>

    <script>
        // Global Data Storage
        let channels = [];
        let users = [];
        let notifications = [];
        let advertisements = [];

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ar-SA', options);
        }
        
        // Show alert
        function showAlert(message, type = 'info', duration = 5000) {
            const alertContainer = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            alertDiv.innerHTML = `
                <div class="alert-icon"><i class="${icons[type] || icons.info}"></i></div>
                <div>${message}</div>
            `;
            
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.remove();
            }, duration);
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalChannels').textContent = channels.length;
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalAds').textContent = advertisements.length;
            document.getElementById('totalNotifications').textContent = notifications.length;
        }

        // M3U Parser
        function parseM3U(content) {
            const lines = content.split('\n');
            const parsedChannels = [];
            let currentChannel = {};
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line.startsWith('#EXTINF:')) {
                    // Parse channel info
                    const info = line.substring(8);
                    const parts = info.split(',');
                    
                    if (parts.length >= 2) {
                        currentChannel.name = parts[1].trim();
                        currentChannel.nameAr = parts[1].trim();
                        
                        // Extract additional info from attributes
                        const attributes = parts[0];
                        if (attributes.includes('tvg-logo=')) {
                            const logoMatch = attributes.match(/tvg-logo="([^"]+)"/);
                            if (logoMatch) currentChannel.logo = logoMatch[1];
                        }
                        
                        if (attributes.includes('group-title=')) {
                            const groupMatch = attributes.match(/group-title="([^"]+)"/);
                            if (groupMatch) currentChannel.category = groupMatch[1];
                        }
                    }
                } else if (line.startsWith('http')) {
                    // This is the stream URL
                    currentChannel.url = line;
                    currentChannel.id = Date.now() + Math.random();
                    currentChannel.description = `ููุงุฉ ${currentChannel.name}`;
                    currentChannel.descriptionAr = `ููุงุฉ ${currentChannel.nameAr}`;
                    currentChannel.isPremium = false;
                    currentChannel.supportsRecording = true;
                    currentChannel.category = currentChannel.category || 'General';
                    
                    parsedChannels.push({ ...currentChannel });
                    currentChannel = {};
                }
            }
            
            return parsedChannels;
        }

        // Add channel
        function addChannel(channelData) {
            channelData.id = Date.now() + Math.random();
            channels.push(channelData);
            updateStats();
            showAlert(`ุชู ุฅุถุงูุฉ ุงูููุงุฉ "${channelData.nameAr || channelData.name}" ุจูุฌุงุญ!`, 'success');
        }

        // Add user
        function addUser(userData) {
            userData.id = Date.now() + Math.random();
            userData.createdAt = new Date().toLocaleDateString('ar-SA');
            users.push(userData);
            updateStats();
            showAlert(`ุชู ุฅุถุงูุฉ ุงููุณุชุฎุฏู "${userData.username}" ุจูุฌุงุญ!`, 'success');
        }

        // Add notification
        function addNotification(notificationData) {
            notificationData.id = Date.now() + Math.random();
            notificationData.createdAt = new Date().toLocaleDateString('ar-SA');
            notifications.push(notificationData);
            updateStats();
            loadNotifications();
            showAlert('ุชู ุฅุถุงูุฉ ุงูุฅุดุนุงุฑ ุจูุฌุงุญ!', 'success');
        }

        // Add advertisement
        function addAdvertisement(adData) {
            adData.id = Date.now() + Math.random();
            adData.createdAt = new Date().toLocaleDateString('ar-SA');
            advertisements.push(adData);
            updateStats();
            loadAdvertisements();
            showAlert('ุชู ุฅุถุงูุฉ ุงูุฅุนูุงู ุจูุฌุงุญ!', 'success');
        }

        // Load notifications
        function loadNotifications() {
            const container = document.getElementById('notificationsContainer');
            
            if (notifications.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช</p>';
                return;
            }
            
            container.innerHTML = notifications.map(notification => `
                <div class="item-card">
                    <div class="item-header">
                        <div class="item-title">${notification.title}</div>
                        <div class="item-actions">
                            <button class="btn btn-small btn-danger" onclick="deleteNotification(${notification.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p>${notification.content}</p>
                    <small>ุงูููุน: ${notification.type} | ${notification.active ? 'ูุดุท' : 'ุบูุฑ ูุดุท'} | ${notification.createdAt}</small>
                </div>
            `).join('');
        }

        // Load advertisements
        function loadAdvertisements() {
            const container = document.getElementById('adsContainer');
            
            if (advertisements.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ุฅุนูุงูุงุช</p>';
                return;
            }
            
            container.innerHTML = advertisements.map(ad => `
                <div class="item-card">
                    <div class="item-header">
                        <div class="item-title">${ad.title}</div>
                        <div class="item-actions">
                            <button class="btn btn-small btn-danger" onclick="deleteAdvertisement(${ad.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p>${ad.description}</p>
                    ${ad.url ? `<p><a href="${ad.url}" target="_blank" style="color: #4ecdc4;">${ad.url}</a></p>` : ''}
                    <small>${ad.active ? 'ูุดุท' : 'ุบูุฑ ูุดุท'} | ${ad.createdAt}</small>
                </div>
            `).join('');
        }

        // Show users list
        function showUsersList() {
            const container = document.getElementById('usersContainer');
            
            if (users.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ูุณุชุฎุฏููู ูุณุฌููู</p>';
            } else {
                container.innerHTML = users.map(user => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${user.username}</div>
                            <div class="item-actions">
                                <button class="btn btn-small btn-danger" onclick="deleteUser(${user.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <p>ุงูุจุฑูุฏ: ${user.email}</p>
                        ${user.phone ? `<p>ุงููุงุชู: ${user.phone}</p>` : ''}
                        <small>${user.isPremium ? 'โญ ูููุฒ' : '๐ค ุนุงุฏู'} | ${user.isActive ? 'โ ูุดุท' : 'โ ุบูุฑ ูุดุท'} | ${user.createdAt}</small>
                    </div>
                `).join('');
            }
            
            openModal('usersModal');
        }

        // Show channels list
        function showChannelsList() {
            const container = document.getElementById('channelsContainer');
            
            if (channels.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.6);">ูุง ุชูุฌุฏ ูููุงุช ูุถุงูุฉ</p>';
            } else {
                container.innerHTML = channels.map(channel => `
                    <div class="item-card">
                        <div class="item-header">
                            <div class="item-title">${channel.nameAr || channel.name}</div>
                            <div class="item-actions">
                                <button class="btn btn-small btn-danger" onclick="deleteChannel(${channel.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <p>ุงูุชุตููู: ${channel.category}</p>
                        <p style="word-break: break-all; font-size: 12px; color: rgba(255,255,255,0.7);">${channel.url}</p>
                        <small>${channel.isPremium ? 'โญ ูููุฒุฉ' : '๐บ ุนุงุฏูุฉ'} | ${channel.supportsRecording ? '๐น ุชุณุฌูู' : '๐ซ ุจุฏูู ุชุณุฌูู'}</small>
                    </div>
                `).join('');
            }
            
            openModal('channelsModal');
        }

        // Show notifications list
        function showNotificationsList() {
            if (notifications.length === 0) {
                showAlert('ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ููุนุฑุถ', 'info');
                return;
            }
            loadNotifications();
        }

        // Show ads list
        function showAdsList() {
            if (advertisements.length === 0) {
                showAlert('ูุง ุชูุฌุฏ ุฅุนูุงูุงุช ููุนุฑุถ', 'info');
                return;
            }
            loadAdvertisements();
        }

        // Delete functions
        function deleteUser(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุณุชุฎุฏูุ')) {
                users = users.filter(user => user.id !== id);
                updateStats();
                showUsersList();
                showAlert('ุชู ุญุฐู ุงููุณุชุฎุฏู ุจูุฌุงุญ', 'success');
            }
        }

        function deleteChannel(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูููุงุฉุ')) {
                channels = channels.filter(channel => channel.id !== id);
                updateStats();
                showChannelsList();
                showAlert('ุชู ุญุฐู ุงูููุงุฉ ุจูุฌุงุญ', 'success');
            }
        }

        function deleteNotification(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฅุดุนุงุฑุ')) {
                notifications = notifications.filter(notification => notification.id !== id);
                updateStats();
                loadNotifications();
                showAlert('ุชู ุญุฐู ุงูุฅุดุนุงุฑ ุจูุฌุงุญ', 'success');
            }
        }

        function deleteAdvertisement(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฅุนูุงูุ')) {
                advertisements = advertisements.filter(ad => ad.id !== id);
                updateStats();
                loadAdvertisements();
                showAlert('ุชู ุญุฐู ุงูุฅุนูุงู ุจูุฌุงุญ', 'success');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            setInterval(updateDateTime, 60000);
            
            // Initialize file uploads
            const channelImageUpload = document.getElementById('channelImageUpload');
            const channelImageFile = document.getElementById('channelImageFile');
            const channelImagePreview = document.getElementById('channelImagePreview');
            
            channelImageUpload.addEventListener('click', () => {
                channelImageFile.click();
            });
            
            channelImageFile.addEventListener('change', function(e) {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        channelImagePreview.src = e.target.result;
                        channelImagePreview.style.display = 'block';
                    }
                    reader.readAsDataURL(this.files[0]);
                }
            });

            // M3U file upload
            const m3uUpload = document.getElementById('m3uUpload');
            const m3uFile = document.getElementById('m3uFile');
            
            m3uUpload.addEventListener('click', () => {
                m3uFile.click();
            });
            
            m3uFile.addEventListener('change', function(e) {
                if (this.files && this.files[0]) {
                    const file = this.files[0];
                    const reader = new FileReader();
                    
                    document.getElementById('m3uProgress').style.display = 'block';
                    let progress = 0;
                    
                    const progressInterval = setInterval(() => {
                        progress += 10;
                        document.getElementById('progressFill').style.width = progress + '%';
                        
                        if (progress >= 100) {
                            clearInterval(progressInterval);
                            document.getElementById('progressText').textContent = 'ุชู ุงูุงูุชูุงุก!';
                            setTimeout(() => {
                                document.getElementById('m3uProgress').style.display = 'none';
                            }, 2000);
                        }
                    }, 200);
                    
                    reader.onload = function(e) {
                        const content = e.target.result;
                        const parsedChannels = parseM3U(content);
                        
                        parsedChannels.forEach(channel => {
                            addChannel(channel);
                        });
                        
                        showAlert(`ุชู ุฅุถุงูุฉ ${parsedChannels.length} ููุงุฉ ูู ููู M3U ุจูุฌุงุญ!`, 'success');
                    };
                    
                    reader.readAsText(file);
                }
            });

            // Ad image upload
            const adImageUpload = document.getElementById('adImageUpload');
            const adImageFile = document.getElementById('adImageFile');
            
            adImageUpload.addEventListener('click', () => {
                adImageFile.click();
            });
            
            // Form submissions
            document.getElementById('addUserForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const userData = {
                    username: document.getElementById('userName').value,
                    email: document.getElementById('userEmail').value,
                    password: document.getElementById('userPassword').value,
                    phone: document.getElementById('userPhone').value,
                    isPremium: document.getElementById('userIsPremium').checked,
                    isActive: document.getElementById('userIsActive').checked
                };
                
                addUser(userData);
                this.reset();
            });
            
            document.getElementById('addChannelForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const channelData = {
                    name: document.getElementById('channelName').value,
                    nameAr: document.getElementById('channelNameAr').value,
                    url: document.getElementById('channelUrl').value,
                    category: document.getElementById('channelCategory').value,
                    description: document.getElementById('channelDescription').value,
                    descriptionAr: document.getElementById('channelDescriptionAr').value,
                    isPremium: document.getElementById('isPremium').checked,
                    supportsRecording: document.getElementById('supportsRecording').checked
                };
                
                addChannel(channelData);
                this.reset();
                channelImagePreview.style.display = 'none';
            });

            document.getElementById('notificationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const notificationData = {
                    title: document.getElementById('notificationTitle').value,
                    content: document.getElementById('notificationContent').value,
                    type: document.getElementById('notificationType').value,
                    active: document.getElementById('notificationActive').checked
                };
                
                addNotification(notificationData);
                this.reset();
                closeModal('notificationModal');
            });

            document.getElementById('adForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const adData = {
                    title: document.getElementById('adTitle').value,
                    description: document.getElementById('adDescription').value,
                    url: document.getElementById('adUrl').value,
                    active: document.getElementById('adActive').checked
                };
                
                addAdvertisement(adData);
                this.reset();
                closeModal('adModal');
            });
            
            // Button event listeners
            document.getElementById('addNotificationBtn').addEventListener('click', function() {
                openModal('notificationModal');
            });
            
            document.getElementById('addAdBtn').addEventListener('click', function() {
                openModal('adModal');
            });
            
            document.getElementById('refreshNotificationsBtn').addEventListener('click', function() {
                loadNotifications();
                showAlert('ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช', 'success');
            });
            
            document.getElementById('refreshAdsBtn').addEventListener('click', function() {
                loadAdvertisements();
                showAlert('ุชู ุชุญุฏูุซ ูุงุฆูุฉ ุงูุฅุนูุงูุงุช', 'success');
            });

            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            });
            
            // Initialize data
            loadNotifications();
            loadAdvertisements();
            updateStats();
            
            // Show initial alerts
            setTimeout(() => {
                showAlert('ูุฑุญุจุงู ุจู ูู ููุญุฉ ุชุญูู TvNa ุงููุทูุฑุฉ!', 'info');
                showAlert('ุฌููุน ุงููุธุงุฆู ูุชุงุญุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู', 'success');
            }, 1000);
        });
    </script>
</body>
</html>
